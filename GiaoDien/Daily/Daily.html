<!DOCTYPE html>
<html lang="vi" ng-app="DaiLyApp">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·∫°i l√Ω - Qu·∫£n l√Ω</title>
    <link rel="stylesheet" href="Daily.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="../js/globalvar.js"></script>
    <script src="Daily.js"></script>
</head>
<body ng-controller="DaiLyCtrl">
    <aside class="sidebar">
        <div class="sidebar-header">
            <div style="display:flex;align-items:center;gap:8px;">
                <span style="color:#4CAF50;font-size:20px;">üè™</span>
                <div style="font-weight:bold;font-size:18px;">ƒê·∫°i L√Ω</div>
            </div>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" ng-click="showPage('dashboard')" ng-class="{'active': currentPage=='dashboard'}">B·∫£ng ƒëi·ªÅu khi·ªÉn</a></li>
            <li><a href="#" ng-click="showPage('donhang')" ng-class="{'active': currentPage=='donhang'}">ƒê∆°n h√†ng N√¥ng D√¢n</a></li>
            <li><a href="#" ng-click="showPage('donhangst')" ng-class="{'active': currentPage=='donhangst'}">ƒê∆°n h√†ng Si√™u Th·ªã</a></li>
            <li><a href="#" ng-click="showPage('kho')" ng-class="{'active': currentPage=='kho'}">Qu·∫£n l√Ω Kho</a></li>
            <li><a href="#" ng-click="showPage('kiemdinh')" ng-class="{'active': currentPage=='kiemdinh'}">Ki·ªÉm ƒë·ªãnh</a></li>
            <li style="border-top:1px solid rgba(255,255,255,0.1);margin-top:10px;padding-top:10px;">
                <a href="#" ng-click="logout()">ƒêƒÉng xu·∫•t</a>
            </li>
        </ul>
    </aside>

    <main class="main-content">
        <!-- Dashboard -->
        <section class="page" ng-class="{'active-page': currentPage=='dashboard'}"></section>
            <div class="page-header">
                <h2>B·∫£ng ƒëi·ªÅu khi·ªÉn</h2>
            </div>
            <div class="kpis">
                <div class="kpi"><h3>{{listDonHangDaiLy.length}}</h3><p>ƒê∆°n h√†ng N√¥ng D√¢n</p></div>
                <div class="kpi"><h3>{{listDonHangSieuThi.length}}</h3><p>ƒê∆°n h√†ng Si√™u Th·ªã</p></div>
                <div class="kpi"><h3>{{listKho.length}}</h3><p>Kho h√†ng</p></div>
                <div class="kpi"><h3>{{listKiemDinh.length}}</h3><p>Ki·ªÉm ƒë·ªãnh</p></div>
            </div>
            
            <div class="lists">
                <div class="list">
                    <h4>ƒê∆°n h√†ng g·∫ßn ƒë√¢y</h4>
                    <table class="table"></table>
                        <thead><tr><th>M√£ ƒêH</th><th>N√¥ng D√¢n</th><th>T·ªïng SL</th><th>Tr·∫°ng th√°i</th></tr></thead>
                        <tbody>
                            <tr ng-repeat="dh in listDonHangDaiLy | limitTo:5">
                                <td>{{dh.maDonHang}}</td>
                                <td>{{dh.tenNongDan}}</td>
                                <td>{{dh.tongSoLuong}}</td>
                                <td>{{dh.trangThai}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="list">
                    <h4>Kho h√†ng</h4>
                    <table class="table">
                        <thead><tr><th>M√£ Kho</th><th>T√™n Kho</th><th>ƒê·ªãa ch·ªâ</th></tr></thead>
                        <tbody>
                            <tr ng-repeat="k in listKho | limitTo:5">
                                <td>{{k.maKho}}</td>
                                <td>{{k.tenKho}}</td>
                                <td>{{k.diaChi}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- ƒê∆°n h√†ng N√¥ng D√¢n -->
        <section class="page" ng-class="{'active-page': currentPage=='donhang'}">
            <div class="page-header">
                <h2>ƒê∆°n h√†ng t·ª´ N√¥ng D√¢n</h2>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>M√£ ƒêH</th>
                        <th>N√¥ng D√¢n</th>
                        <th>Ng√†y ƒë·∫∑t</th>
                        <th>Ng√†y giao</th>
                        <th>T·ªïng SL</th>
                        <th>T·ªïng gi√° tr·ªã</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="dh in listDonHangDaiLy">
                        <td>{{dh.maDonHang}}</td>
                        <td>{{dh.tenNongDan}}</td>
                        <td>{{dh.ngayDat | date:'dd/MM/yyyy'}}</td>
                        <td>{{dh.ngayGiao | date:'dd/MM/yyyy'}}</td>
                        <td>{{dh.tongSoLuong}}</td>
                        <td>{{dh.tongGiaTri | number}} VNƒê</td>
                        <td>{{dh.trangThai}}</td>
                        <td>
                            <button class="btn small" ng-click="updateTrangThaiDonHangDaiLy(dh.maDonHang, 'da_nhan')">ƒê√£ nh·∫≠n</button>
                            <button class="btn small btn-delete" ng-click="deleteDonHangDaiLy(dh.maDonHang)">X√≥a</button>
                        </td>
                    </tr>
                    <tr ng-if="listDonHangDaiLy.length == 0">
                        <td colspan="8" style="text-align:center;color:#999;">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- ƒê∆°n h√†ng Si√™u Th·ªã -->
        <section class="page" ng-class="{'active-page': currentPage=='donhangst'}">
            <div class="page-header">
                <h2>ƒê∆°n h√†ng t·ª´ Si√™u Th·ªã</h2>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>M√£ ƒêH</th>
                        <th>Si√™u Th·ªã</th>
                        <th>Ng√†y ƒë·∫∑t</th>
                        <th>Ng√†y giao</th>
                        <th>T·ªïng SL</th>
                        <th>T·ªïng gi√° tr·ªã</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="dh in listDonHangSieuThi">
                        <td>{{dh.maDonHang}}</td>
                        <td>{{dh.tenSieuThi}}</td>
                        <td>{{dh.ngayDat | date:'dd/MM/yyyy'}}</td>
                        <td>{{dh.ngayGiao | date:'dd/MM/yyyy'}}</td>
                        <td>{{dh.tongSoLuong}}</td>
                        <td>{{dh.tongGiaTri | number}} VNƒê</td>
                        <td>{{dh.trangThai}}</td>
                        <td>
                            <button class="btn small" ng-click="updateTrangThaiDonHangSieuThi(dh.maDonHang, 'dang_giao')">ƒêang giao</button>
                            <button class="btn small" ng-click="updateTrangThaiDonHangSieuThi(dh.maDonHang, 'da_giao')">ƒê√£ giao</button>
                        </td>
                    </tr>
                    <tr ng-if="listDonHangSieuThi.length == 0">
                        <td colspan="8" style="text-align:center;color:#999;">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Qu·∫£n l√Ω Kho -->
        <section class="page" ng-class="{'active-page': currentPage=='kho'}">
            <div class="page-header">
                <h2>Qu·∫£n l√Ω Kho</h2>
                <button class="btn" ng-click="openModal('kho')">+ Th√™m Kho</button>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>M√£ Kho</th>
                        <th>Lo·∫°i Kho</th>
                        <th>T√™n Kho</th>
                        <th>ƒê·ªãa ch·ªâ</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Ng√†y t·∫°o</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="k in listKho">
                        <td>{{k.maKho}}</td>
                        <td>{{k.loaiKho}}</td>
                        <td>{{k.tenKho}}</td>
                        <td>{{k.diaChi}}</td>
                        <td>{{k.trangThai}}</td>
                        <td>{{k.ngayTao | date:'dd/MM/yyyy'}}</td>
                        <td>
                            <button class="btn small btn-edit" ng-click="editKho(k)">S·ª≠a</button>
                            <button class="btn small btn-delete" ng-click="deleteKho(k.maKho)">X√≥a</button>
                        </td>
                    </tr>
                    <tr ng-if="listKho.length == 0">
                        <td colspan="7" style="text-align:center;color:#999;">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Ki·ªÉm ƒë·ªãnh -->
        <section class="page" ng-class="{'active-page': currentPage=='kiemdinh'}">
            <div class="page-header">
                <h2>Ki·ªÉm ƒë·ªãnh Ch·∫•t l∆∞·ª£ng</h2>
                <button class="btn" ng-click="openModal('kiemdinh')">+ Th√™m Ki·ªÉm ƒë·ªãnh</button>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>M√£ Kƒê</th>
                        <th>M√£ L√¥</th>
                        <th>Ng∆∞·ªùi ki·ªÉm ƒë·ªãnh</th>
                        <th>Ng√†y ki·ªÉm ƒë·ªãnh</th>
                        <th>K·∫øt qu·∫£</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Ghi ch√∫</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="kd in listKiemDinh">
                        <td>{{kd.maKiemDinh}}</td>
                        <td>{{kd.maLo}}</td>
                        <td>{{kd.nguoiKiemDinh}}</td>
                        <td>{{kd.ngayKiemDinh | date:'dd/MM/yyyy'}}</td>
                        <td>{{kd.ketQua}}</td>
                        <td>{{kd.trangThai}}</td>
                        <td>{{kd.ghiChu}}</td>
                        <td>
                            <button class="btn small btn-edit" ng-click="editKiemDinh(kd)">S·ª≠a</button>
                            <button class="btn small btn-delete" ng-click="deleteKiemDinh(kd.maKiemDinh)">X√≥a</button>
                        </td>
                    </tr>
                    <tr ng-if="listKiemDinh.length == 0">
                        <td colspan="8" style="text-align:center;color:#999;">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <!-- Modal -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" ng-click="closeModal()">&times;</button>
            <div id="modal-body">
                <!-- Form Kho -->
                <form ng-show="currentModal=='kho'" class="modal-form" ng-submit="saveKho()">
                    <h3>{{isEditKho ? 'S·ª≠a Kho' : 'Th√™m Kho'}}</h3>
                    <label>Lo·∫°i kho</label>
                    <select ng-model="formKho.loaiKho" required>
                        <option value="">-- Ch·ªçn lo·∫°i kho --</option>
                        <option value="daily">ƒê·∫°i l√Ω</option>
                        <option value="sieuthi">Si√™u th·ªã</option>
                    </select>
                    <label>T√™n kho</label>
                    <input type="text" ng-model="formKho.tenKho" placeholder="T√™n kho" required />
                    <label>ƒê·ªãa ch·ªâ</label>
                    <input type="text" ng-model="formKho.diaChi" placeholder="ƒê·ªãa ch·ªâ" />
                    <label>M√£ ƒê·∫°i L√Ω</label>
                    <input type="number" ng-model="formKho.maDaiLy" placeholder="M√£ ƒë·∫°i l√Ω" />
                    <div class="modal-actions">
                        <button type="button" class="btn cancel" ng-click="closeModal()">H·ªßy</button>
                        <button type="submit" class="btn">L∆∞u</button>
                    </div>
                </form>

                <!-- Form Ki·ªÉm ƒë·ªãnh -->
                <form ng-show="currentModal=='kiemdinh'" class="modal-form" ng-submit="saveKiemDinh()">
                    <h3>{{isEditKiemDinh ? 'S·ª≠a Ki·ªÉm ƒë·ªãnh' : 'Th√™m Ki·ªÉm ƒë·ªãnh'}}</h3>
                    <label>M√£ L√¥</label>
                    <input type="number" ng-model="formKiemDinh.maLo" placeholder="M√£ l√¥" required />
                    <label>Ng∆∞·ªùi ki·ªÉm ƒë·ªãnh</label>
                    <input type="text" ng-model="formKiemDinh.nguoiKiemDinh" placeholder="Ng∆∞·ªùi ki·ªÉm ƒë·ªãnh" />
                    <label>M√£ ƒê·∫°i L√Ω</label>
                    <input type="number" ng-model="formKiemDinh.maDaiLy" placeholder="M√£ ƒë·∫°i l√Ω" />
                    <label>K·∫øt qu·∫£</label>
                    <select ng-model="formKiemDinh.ketQua" required>
                        <option value="">-- Ch·ªçn k·∫øt qu·∫£ --</option>
                        <option value="dat">ƒê·∫°t</option>
                        <option value="khong_dat">Kh√¥ng ƒë·∫°t</option>
                        <option value="cho_xu_ly">Ch·ªù x·ª≠ l√Ω</option>
                    </select>
                    <label>Bi√™n b·∫£n</label>
                    <textarea ng-model="formKiemDinh.bienBan" placeholder="Bi√™n b·∫£n ki·ªÉm ƒë·ªãnh" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;"></textarea>
                    <label>Ghi ch√∫</label>
                    <input type="text" ng-model="formKiemDinh.ghiChu" placeholder="Ghi ch√∫" />
                    <div class="modal-actions">
                        <button type="button" class="btn cancel" ng-click="closeModal()">H·ªßy</button>
                        <button type="submit" class="btn">L∆∞u</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
